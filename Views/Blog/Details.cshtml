@model HumanBodyWeb.Models.BlogPost
@using System.Net

@{
    ViewData["Title"] = Model.Title;
    var readableDate = Model.PublishedOn?.ToString("dd MMMM yyyy");
}

<article class="container py-4">

    <!-- ---------- Başlık & Kategori ---------- -->
    <h1 class="display-5 fw-bold">@Model.Title</h1>

    @* Kategori adı varsa göster *@
    @if (Model.Category != null)
    {
        <span class="badge bg-secondary me-2">@Model.Category.Name</span>
    }

    <span class="text-muted">@readableDate</span>

    <!-- ---------- Öne çıkarılmış görsel ---------- -->
    @if (!string.IsNullOrEmpty(Model.FeaturedImageUrl))
    {
        <div class=" my-4">
            <img src="@Model.FeaturedImageUrl" alt="@Model.Title" class="img-fluid rounded shadow-sm"
                style="max-width:600px; width:100%; height:auto;" />
        </div>
    }

    <!-- ---------- İçerik ---------- -->
    <div class="post-body">
        @Html.Raw(
        WebUtility.HtmlDecode(
        WebUtility.HtmlDecode(Model.Content) /* iki kat decode - eski veriler için */
        )
                )
    </div>

    <!-- ---------- Düzenle / Sil (yalnızca oturum açık) ---------- -->
    @if (User.Identity?.IsAuthenticated ?? false)
    {
        <div class="mt-4">
            <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-outline-primary me-2">
                <i class="bi bi-pencil me-1"></i> Edit
            </a>

            <form asp-action="Delete" asp-route-id="@Model.Id" method="post" class="d-inline"
                onsubmit="return confirm('Bu yazıyı silmek istediğinize emin misiniz?');">
                <button type="submit" class="btn btn-outline-danger">
                    <i class="bi bi-trash me-1"></i> Delete
                </button>
            </form>
        </div>
    }
</article>
